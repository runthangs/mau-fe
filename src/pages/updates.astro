---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';

const updates = [
  {
    date: 'December 2025',
    title: 'Issue 07: Planning Update',
    description: 'Step by step - building with purpose. Update on planning progress, highways approval, and bat surveys.',
    image: '/images/newsletters/mau-newsletter-2025-12-issue-07.jpg',
    tags: ['Newsletter', 'Planning']
  },
  {
    date: 'December 2025',
    title: 'Giving Tuesday Leaderboard',
    description: 'A huge thank you to our supporters. We reached the top of the Giving Tuesday leaderboard!',
    image: '/images/newsletters/mau-newsletter-2025-12-giving-tuesday.jpg',
    tags: ['Fundraising']
  },
  {
    date: 'November 2025',
    title: 'Planning Application Submitted',
    description: 'A major milestone reached. We have officially submitted our planning application for the new Masjid Al Ummah.',
    image: '/images/newsletters/mau-newsletter-2025-11-planning-submitted.jpg',
    tags: ['Milestone', 'Planning']
  },
  {
    date: 'November 2025',
    title: 'Nascot Residents Association AGM',
    description: 'Engaging with our neighbours. We were invited to present our eco-friendly design and community plans.',
    image: '/images/newsletters/mau-newsletter-2025-11-planning-update.jpg',
    tags: ['Community', 'Engagement']
  },
  {
    date: 'September 2025',
    title: 'Issue 06: Community BBQ Success',
    description: 'Recap of our August event which drew 300 enthusiastic visitors to the site.',
    image: '/images/newsletters/mau-newsletter-2025-09-issue-06-recap.jpg',
    tags: ['Newsletter', 'Event Recap']
  },
  {
    date: 'August 2025',
    title: 'Community Open Day & BBQ',
    description: 'Inviting the community to review plans, share feedback, and enjoy a summer BBQ.',
    image: '/images/newsletters/mau-newsletter-2025-08-issue-05-invite.jpg',
    tags: ['Event', 'Community']
  },
  {
    date: 'June 2025',
    title: 'Issue 04: The Story of Hajj',
    description: 'Reflecting on the legacy of faith and sacrifice during the blessed month of Dhul-Hijjah.',
    image: '/images/newsletters/mau-newsletter-2025-06-issue-04.jpg',
    tags: ['Newsletter', 'Faith']
  },
  {
    date: 'June 2025',
    title: 'Eid Al-Adha Mubarak',
    description: 'Wishing our community health, happiness and imaan on this blessed occasion.',
    image: '/images/newsletters/mau-newsletter-2025-06-eid-al-adha.jpg',
    tags: ['Holiday']
  },
  {
    date: 'May 2025',
    title: 'Open Day Recap',
    description: 'Highlights from our April Open Day: 250 attendees and incredible support from the community.',
    image: '/images/newsletters/mau-newsletter-2025-05-open-day-recap.jpg',
    tags: ['Event Recap']
  },
  {
    date: 'April 2025',
    title: 'Open Day Invitation',
    description: 'Come and explore the space before transformation begins. Join us at 68 Langley Road.',
    image: '/images/newsletters/mau-newsletter-2025-04-open-day-invite.jpg',
    tags: ['Event']
  },
  {
    date: 'April 2025',
    title: 'Flash Update 01',
    description: 'Masjid and Musallah collections update. Â£39k collected thanks to the generosity of the Ummah.',
    image: '/images/newsletters/mau-newsletter-2025-04-flash-update-01.jpg',
    tags: ['Fundraising']
  },
  {
    date: 'April 2025',
    title: 'Issue 02: Inside View',
    description: 'Eid Mubarak messages and community views from our trustees.',
    image: '/images/newsletters/mau-newsletter-2025-04-issue-02.jpg',
    tags: ['Newsletter']
  },
  {
    date: 'March 2025',
    title: 'Issue 01: Welcome',
    description: 'Our first newsletter. Sharing our vision during the blessed month of Ramadan.',
    image: '/images/newsletters/mau-newsletter-2025-03-issue-01.jpg',
    tags: ['Newsletter', 'Launch']
  }
];
---

<Layout title="Updates" description="Follow the journey of Masjid Al Ummah. Newsletters, planning updates, and community events.">
  <div class="bg-dark text-white py-20">
    <div class="container mx-auto px-4 text-center">
      <h1 class="text-5xl font-bold mb-6 text-white">Project Updates</h1>
      <p class="text-xl text-gray-300 max-w-2xl mx-auto">
        Follow our journey as we build Masjid Al Ummah. From planning milestones to community gatherings.
      </p>
    </div>
  </div>

  <section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-7xl mx-auto">
        {updates.map((update) => (
          <div
            class="bg-white rounded-xl shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden group flex flex-col h-full cursor-pointer border border-gray-100"
            onclick={`openLightbox('${update.image}', '${update.title}')`}
          >
            <!-- Image container - showing full aspect ratio -->
            <div class="relative bg-gray-100 overflow-hidden">
              <img
                src={update.image}
                alt={update.title}
                class="w-full h-auto object-cover group-hover:scale-105 transition-transform duration-500"
                loading="lazy"
              />
              <div class="absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100">
                <span class="bg-white text-dark px-5 py-2.5 rounded-full text-sm font-bold shadow-lg transform translate-y-4 group-hover:translate-y-0 transition-all flex items-center gap-2">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7" />
                  </svg>
                  View Full Size
                </span>
              </div>
            </div>

            <div class="p-6 flex flex-col flex-grow relative">
              <div class="flex items-center justify-between mb-3">
                <span class="text-sm font-bold text-primary flex items-center gap-1.5">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                  </svg>
                  {update.date}
                </span>
              </div>

              <h3 class="text-xl font-bold text-dark mb-3 group-hover:text-primary transition-colors leading-tight">{update.title}</h3>

              <p class="text-gray-600 text-sm leading-relaxed mb-4 flex-grow">
                {update.description}
              </p>

              <div class="flex flex-wrap gap-2 mt-auto pt-4 border-t border-gray-100">
                {update.tags.map(tag => (
                  <span class="text-[10px] font-semibold text-gray-500 bg-gray-100 px-2 py-1 rounded uppercase tracking-wide">{tag}</span>
                ))}
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Lightbox Modal -->
  <div id="lightbox" class="fixed inset-0 bg-black/95 z-[60] hidden items-center justify-center p-4 opacity-0 transition-opacity duration-300" onclick="closeLightbox()">
    <button class="absolute top-4 right-4 text-white/80 hover:text-white text-4xl focus:outline-none z-50 p-2" onclick="closeLightbox()">&times;</button>
    <div class="relative max-w-5xl max-h-screen w-full h-full flex items-center justify-center">
        <img id="lightbox-img" src="" alt="" class="max-w-full max-h-[90vh] object-contain rounded-sm shadow-2xl transform scale-95 transition-transform duration-300" onclick="event.stopPropagation()" />
    </div>
  </div>

  <script is:inline>
    function openLightbox(src, alt) {
      const lightbox = document.getElementById('lightbox');
      const img = document.getElementById('lightbox-img');

      img.src = src;
      img.alt = alt;

      lightbox.classList.remove('hidden');
      // Small delay to allow display:block to apply before changing opacity for fade effect
      setTimeout(() => {
        lightbox.classList.remove('opacity-0');
        img.classList.remove('scale-95');
        img.classList.add('scale-100');
      }, 10);

      document.body.style.overflow = 'hidden';
    }

    function closeLightbox() {
      const lightbox = document.getElementById('lightbox');
      const img = document.getElementById('lightbox-img');

      lightbox.classList.add('opacity-0');
      img.classList.remove('scale-100');
      img.classList.add('scale-95');

      setTimeout(() => {
        lightbox.classList.add('hidden');
        document.body.style.overflow = '';
      }, 300);
    }

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeLightbox();
    });
  </script>
</Layout>